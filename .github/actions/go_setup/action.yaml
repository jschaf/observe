name: Go Setup
description: Setup Go for testing and compilation.
runs:
  using: composite
  steps:
    - name: Date
      id: date
      run: |
        date -u "+week-number=week-%U" >> $GITHUB_OUTPUT
      shell: bash

    - name: Go build cache
      uses: actions/cache@v4
      with:
        path: |
          ~/.cache/go-build
        key: ${{ runner.os }}-${{ runner.arch }}-go-build-${{ hashFiles('go.mod') }}-${{ steps.date.outputs.week-number }}
        restore-keys: |
          ${{ runner.os }}-go-
    
    - name: setup Go
      shell: bash
      run: ${GITHUB_WORKSPACE}/.github/actions/go_setup/go.sh
